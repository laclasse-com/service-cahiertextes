<div class="panel panel-default">
  <div class="panel-heading">
    <div class="row">
      <h4 class="col-md-6 pull-left">{{enseignant.prenom}} {{enseignant.nom}}</h4>

      <select class="col-md-3 pull-right" data-ng-model="classe" data-ng-change="process_data()" data-ng-options="class as class.libelle for (id, class) in classes | orderBy:'libelle'">
	<option value="">Toutes les classes</option>
      </select>


      <select class="col-md-3 pull-right" data-ng-model="moisCourant" data-ng-change="process_data()" data-ng-options="mois.indexOf(m)+1 as m for m in mois">
	<option value="">Toute l'année</option>
      </select>
    </div>
  </div>

  <div class="panel-body">
    <div class="col-md-4">
      <div class="panel panel-default">
	<div class="panel-body">
	  <legend><span class="glyphicon glyphicon-envelope"></span> <a href="mailto:{{enseignant.emails[0].adresse}}">{{enseignant.emails[0].adresse}}</a></legend>

	  <fieldset data-ng-if="enseignant.prof_principal.length > 0">
	    <legend><span class="glyphicon glyphicon-bell"></span> Professeur principal de</legend>
	    <span class="label label-info pull-left" data-ng-repeat="classe in enseignant.prof_principal">{{classe}}</span>
	  </fieldset>

	  <fieldset>
	    <legend><span class="glyphicon glyphicon-briefcase"></span> Matières enseignées</legend>
	    <span class="label label-primary pull-left" data-ng-repeat="matiere in enseignant.liste_matieres">{{matiere}}</span>
	  </fieldset>
	  <fieldset>
	    <legend><span class="glyphicon glyphicon-envelope"></span> Classes</legend>
	    <span class="label label-info pull-left" data-ng-repeat="classe in enseignant.liste_classes">{{classe.classe_libelle}}</span>
	  </fieldset>
	</div>
      </div>
    </div>
    <div class="col-md-8">
      <div class="panel panel-default">
	<div class="panel-body row">
	  <nvd3-pie-chart id="globalPieChart" class="col-md-4"
			  data="graphiques.pieChart.data"
			  objectEquality="true"
			  noData="Aucune saisie"
			  margin="{left:0,top:0,bottom:0,right:0}"
			  showLegend="true"
			  tooltips="true"
			  color="graphiques.pieChart.colorFunction()"
			  legendColor="graphiques.pieChart.colorFunction()"
			  x="graphiques.pieChart.xFunction()"
			  y="graphiques.pieChart.yFunction()" >
	    <svg></svg>
	  </nvd3-pie-chart>
	  <nvd3-multi-bar-chart id="globalBarChart" class="col-md-8"
				data="graphiques.barChart.data"
				objectEquality="true"
				noData="Aucune saisie"
				rotateLabels="20"
				height="256"
				showXAxis="true"
				showYAxis="true"
				showControls="false"
				showLegend="true"
				tooltips="true"
				color="graphiques.barChart.colorFunction()"
				legendColor="graphiques.barChart.colorFunction()"
				tooltipcontent="graphiques.barChart.tooltipContent()"
				xAxisTickFormat="graphiques.barChart.xAxisTickFormatFunction()" >
	    <svg></svg>
	  </nvd3-multi-bar-chart>
	</div>
      </div>
    </div>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    <label>
      <input type="checkbox"
	     data-ng-model="scope.montre_valides"
	     data-ng-change="process_data()" />
      afficher les saisies visées
    </label>
    <button class="pull-right"
	    data-ng-click="valide_all()"
	    data-ng-if="current_user.profil_actif.type === 'DIR'">
      <span class="glyphicon glyphicon-check"></span> Viser la totalité
    </button>
    <div class="clearfix"></div>
  </div>
  <div class="panel-body">
    <table class="table">
      <thead>
	<tr>
	  <th>Classe</th>
	  <th>Matière</th>
	  <th>Cours</th>
	  <th>Travail à faire</th>
	  <th>Visée</th>
	</tr>
      </thead>
      <tbody>
	<tr data-ng-repeat="saisie in raw_data"
	    data-ng-class="{'even': $even, 'odd': $odd}"
	    data-ng-if="scope.montre_valides || !saisie.valide">
	  <td data-ng-bind="classes[ saisie.regroupement_id ].libelle"></td>
	  <td data-ng-bind="matieres[ saisie.matiere_id ].libelle_long"></td>
	  <td data-ng-bind-html="saisie.cours.contenu"></td>
	  <td>
	    <div data-ng-repeat="devoir in saisie.devoirs" data-ng-bind-html="devoir.contenu"></div>
	  </td>
	  <td>
	    <div data-ng-switcher
		 data-ng-if="current_user.profil_actif.type === 'DIR'"
		 data-ng-model="saisie.valide"
		 data-ng-change="valide( saisie )" >
	    </div>
	    <div data-ng-if="current_user.profil_actif.type !== 'DIR'">
	      <div class="switch disabled"
		   ng-class="{'switch-left': !saisie.valide, 'switch-right': saisie.valide}">
		<div class="switch-button"> </div>
	      </div>
	    </div>
	  </td>
	</tr>
      </tbody>
    </table>
  </div>
</div>
